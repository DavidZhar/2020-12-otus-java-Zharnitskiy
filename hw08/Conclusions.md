### HW08

Программа анализирует эффективность и особенности работы различных сборщиков мусора.  
Механизм действия: в два листа в цикле одновременно добавляются объекты,
один из них регулярно очищается. Таким образом, область памяти JVM Heap постепенно 
заполняется, но в то же время появляются ненужные и готовые к удалению сборщиком 
мусора объекты. Время от времени поток исполнения засыпает, причем так, 
чтобы программа падала с OutOfMemoryError примерно через 5 минут после 
старта программы с настройками -XX:+UseG1GC -Xmx256m. С каждым вариантом настроек 
было произведено несколько запусков, но между ними не было замечено статистически 
значимых различий, поэтому ниже приведено по одному запуску на каждый вариант настроек.    

#### Поминутная статистика работы программы и сборщиков мусора в зависимости от настроек памяти и GC:

#### -XX:+UseG1GC

| -Xmx256m           |           |    |    |     |       |
|--------------------|-----------|----|----|-----|-------|
| Minutes            | 1         | 2  | 3  | 4   | Total |
| GC Time (ms):      | 78        | 88 | 96 | 610 | 1309  |
| GC Young amount    | 4         | 5  | 6  | 11  | 29    |
| GC Full amount     | 0         | 0  | 0  | 4   | 7     |
| Total time (ms):   | 249.355   |    |    |     |       |
| Objects in list 1: | 9.230.100 |    |    |     |       |

| -Xmx384m           |            |    |    |    |    |       |
|--------------------|------------|----|----|----|----|-------|
| Minutes            | 1          | 2  | 3  | 4  | 5  | Total |
| GC Time (ms):      | 69         | 96 | 66 | 74 | 59 | 1072  |
| GC Young amount    | 4          | 5  | 5  | 4  | 6  | 31    |
| GC Full amount     | 0          | 0  | 0  | 0  | 0  | 3     |
| Total time (ms):   | 353.851    |    |    |    |    |       |
| Objects in list 1: | 13.845.150 |    |    |    |    |       |

#### -XX:+UseSerialGC

| -Xmx256m           |           |     |     |     |       |
|--------------------|-----------|-----|-----|-----|-------|
| Minutes            | 1         | 2   | 3   | 4   | Total |
| GC Time (ms):      | 122       | 167 | 523 | 942 |\> 1754|
| GC Young amount    | 2         | 2   | 2   | 0   | \> 6  |
| GC Full amount     | 0         | 0   | 2   | 4   | \> 6  |
| Total time (ms):   | 270.138   |     |     |     |       |
| Objects in list 1: | 9.100.223 |     |     |     |       |

| -Xmx384m           |            |     |     |    |     |     |       |
|--------------------|------------|-----|-----|----|-----|-----|-------|
| Minutes            | 1          | 2   | 3   | 4  | 5   | 6   | Total |
| GC Time (ms):      | 125        | 170 | 266 | 95 | 640 | 403 |\> 1699|
| GC Young amount    | 2          | 2   | 1   | 1  | 2   | 0   | \> 8  |
| GC Full amount     | 0          | 0   | 1   | 0  | 2   | 1   | \> 4  |
| Total time (ms):   | 568.369    |     |     |    |     |     |       |
| Objects in list 1: | 13.719.081 |     |     |    |     |     |       |

#### -XX:+UseParallelGC

| -Xmx256m           |           |     |       |
|--------------------|-----------|-----|-------|
| Minutes            | 1         | 2   | Total |
| GC Time (ms):      | 84        | 144 | 918   |
| GC Young amount    | 2         | 2   | 5     |
| GC Full amount     | 0         | 0   | 2     |
| Total time (ms):   | 168.833   |     |       |
| Objects in list 1: | 6.153.400 |     |       |

| -Xmx384m           |           |     |     |     |       |
|--------------------|-----------|-----|-----|-----|-------|
| Minutes            | 1         | 2   | 3   | 4   | Total |
| GC Time (ms):      | 71        | 141 | 486 | 969 | 1667  |
| GC Young amount    | 2         | 2   | 2   | 3   | 9     |
| GC Full amount     | 0         | 0   | 1   | 1   | 2     |
| Total time (ms):   | 253.829   |     |     |     |       |
| Objects in list 1: | 9.230.100 |     |     |     |       |

#### -XX:+UseZGC

| -Xmx256m           |           |      |       |
|--------------------|-----------|------|-------|
| Minutes            | 1         | 2    | Total |
| GC Time (ms):      | 574       | 1045 | 2485  |
| GC Young amount    | 0         | 0    | 0     |
| GC Full amount     | 5         | 5    | 13    |
| Total time (ms):   | 169.385   |      |       |
| Objects in list 1: | 6.153.400 |      |       |

| -Xmx384m           |           |     |      |     |       |
|--------------------|-----------|-----|------|-----|-------|
| Minutes            | 1         | 2   | 3    | 4   | Total |
| GC Time (ms):      | 361       | 696 | 1536 | 835 | 3904  |
| GC Young amount    | 0         | 0   | 0    | 0   | 0     |
| GC Full amount     | 2         | 3   | 4    | 2   | 13    |
| Total time (ms):   | 255.425   |     |      |     |       |
| Objects in list 1: | 9.230.100 |     |      |     |       |

В каждом случае настроек GC при дальнейшем увеличении хипа поведение 
программы изменялось пропорционально.

#### Выводы:
Как ни странно, с конкретной задачей SerialGC справился почти точно так же, 
как и G1GC: с обоими сборщиками мусора программа смогла выработать 
максимальное количество объектов, однако все же с G1GC программа отрабатывала 
быстрее, так что на большем масштабе были бы сильнее заметны более долгие паузы
у GC предыдущего поколения.
ParallelGC и ZGC намного хуже справились с очисткой памяти в данном случае, в обоих
случаях было выработана значительно меньше объектов, а программа быстрее падала с OutOfMemory. 
Каждая пауза также была намного длиннее, нежели в предыдущих случаях, причем у ZGC самые длинные,
что, возможно, связано с тем, что я как-то неправильно его настроил (возможно, он требует 
дополнительных настроек для эффективной работы с небольшими объектами в большом количестве).  
В конкретном случае все-таки очевидным лучшим
решением стало бы использование G1GC: у него самые короткие паузы STW, частота
и длина которых возрастает только по мере необходимости - например, когда память
оказывается почти заполнена.  
